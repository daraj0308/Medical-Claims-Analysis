<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Medical Claims Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Chart.js (CDN) for interactive charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body{font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial; margin:24px; color:#111}
    h1{margin:0 0 4px 0} .muted{color:#666}
    .kpis{display:flex; gap:16px; flex-wrap:wrap; margin:16px 0}
    .card{border:1px solid #eee; border-radius:12px; padding:12px; min-width:170px}
    .big{font-size:20px; font-weight:700}
    .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:18px; margin-top:14px}
    table{border-collapse:collapse; width:100%} th,td{border:1px solid #e5e7eb; padding:8px; text-align:left} th{background:#f7f8fa}
    canvas{background:#fff; border:1px solid #eee; border-radius:12px; padding:10px}
    a.btn{display:inline-block; background:#111; color:#fff; padding:8px 12px; border-radius:8px; text-decoration:none}
  </style>
</head>
<body>
  <h1>Medical Claims Dashboard</h1>
  <div class="muted">Interactive visuals rendered entirely in the browser (no backend needed).</div>

  <div id="kpis" class="kpis"></div>

  <div class="grid">
    <div>
      <h3>Denied Dollars by Code</h3>
      <canvas id="denialChart" height="220"></canvas>
    </div>
    <div>
      <h3>Allowed $ by Claim Type</h3>
      <canvas id="allowedChart" height="220"></canvas>
    </div>
  </div>

  <h3 style="margin-top:18px;">Raw Data (sample)</h3>
  <table id="tbl"><thead>
    <tr><th>ClaimID</th><th>Type</th><th>Date</th><th>Billed $</th><th>Allowed $</th><th>Paid $</th><th>Denied?</th><th>Code</th></tr>
  </thead><tbody></tbody></table>

  <!-- Embed data so this file is standalone.
       If you prefer, you can delete this block and fetch your CSV instead. -->
  <script type="application/json" id="claims">
  [
    {"ClaimID":1001,"MemberID":"M001","ProviderID":"P001","ClaimType":"Professional","PlaceOfService":"11 Office","DateOfService":"2024-01-12","Billed":5000,"Allowed":2600,"Paid":2450,"DeniedFlag":0,"DenialCode":"","DX1":"I10"},
    {"ClaimID":1002,"MemberID":"M002","ProviderID":"P002","ClaimType":"Outpatient","PlaceOfService":"22 Outpatient Hospital","DateOfService":"2024-02-03","Billed":2300,"Allowed":1200,"Paid":0,"DeniedFlag":1,"DenialCode":"45","DX1":"E11.9"},
    {"ClaimID":1003,"MemberID":"M003","ProviderID":"P001","ClaimType":"Professional","PlaceOfService":"11 Office","DateOfService":"2024-02-10","Billed":1200,"Allowed":800,"Paid":760,"DeniedFlag":0,"DenialCode":"","DX1":"E78.5"},
    {"ClaimID":1004,"MemberID":"M004","ProviderID":"P003","ClaimType":"Inpatient","PlaceOfService":"21 Inpatient Hospital","DateOfService":"2024-03-01","Billed":9000,"Allowed":5200,"Paid":4900,"DeniedFlag":0,"DenialCode":"","DX1":"I50.9"},
    {"ClaimID":1005,"MemberID":"M005","ProviderID":"P002","ClaimType":"Professional","PlaceOfService":"11 Office","DateOfService":"2024-03-05","Billed":4500,"Allowed":2000,"Paid":0,"DeniedFlag":1,"DenialCode":"96","DX1":"F32.9"},
    {"ClaimID":1006,"MemberID":"M001","ProviderID":"P001","ClaimType":"Professional","PlaceOfService":"11 Office","DateOfService":"2024-03-22","Billed":700,"Allowed":400,"Paid":380,"DeniedFlag":0,"DenialCode":"","DX1":"I10"},
    {"ClaimID":1007,"MemberID":"M006","ProviderID":"P004","ClaimType":"Outpatient","PlaceOfService":"22 Outpatient Hospital","DateOfService":"2024-04-02","Billed":3200,"Allowed":1500,"Paid":1450,"DeniedFlag":0,"DenialCode":"","DX1":"J45.909"},
    {"ClaimID":1008,"MemberID":"M007","ProviderID":"P005","ClaimType":"Professional","PlaceOfService":"11 Office","DateOfService":"2024-04-20","Billed":850,"Allowed":450,"Paid":0,"DeniedFlag":1,"DenialCode":"97","DX1":"K21.9"},
    {"ClaimID":1009,"MemberID":"M008","ProviderID":"P002","ClaimType":"Inpatient","PlaceOfService":"21 Inpatient Hospital","DateOfService":"2024-05-07","Billed":11000,"Allowed":6000,"Paid":5700,"DeniedFlag":0,"DenialCode":"","DX1":"J18.9"},
    {"ClaimID":1010,"MemberID":"M009","ProviderID":"P006","ClaimType":"Professional","PlaceOfService":"11 Office","DateOfService":"2024-05-19","Billed":1500,"Allowed":900,"Paid":870,"DeniedFlag":0,"DenialCode":"","DX1":"M54.50"}
  ]
  </script>

  <script>
    const data = JSON.parse(document.getElementById('claims').textContent);

    // KPIs
    const sum = k => data.reduce((a,r)=>a+Number(r[k]||0),0);
    const denialRate = data.filter(r=>Number(r.DeniedFlag)===1).length / data.length;
    const kpiList = [
      ["Total Claims", data.length],
      ["Billed $", sum("Billed").toFixed(2)],
      ["Allowed $", sum("Allowed").toFixed(2)],
      ["Paid $", sum("Paid").toFixed(2)],
      ["Denial Rate", (denialRate*100).toFixed(1) + "%"]
    ];
    document.getElementById('kpis').innerHTML = kpiList.map(([k,v]) =>
      `<div class="card"><div class="muted">${k}</div><div class="big">${v}</div></div>`).join("");

    // Denied dollars by code
    const deniedAgg = data.filter(r=>Number(r.DeniedFlag)===1)
      .map(r=>({code:r.DenialCode||"(none)", dollars:(Number(r.Allowed||0)-Number(r.Paid||0))}))
      .reduce((m,r)=>(m[r.code]=(m[r.code]||0)+r.dollars, m), {});
    const denialLabels = Object.keys(deniedAgg);
    const denialValues = Object.values(deniedAgg);

    new Chart(document.getElementById('denialChart'), {
      type: 'bar',
      data: { labels: denialLabels, datasets: [{ label: 'Denied $', data: denialValues }] },
      options: { responsive: true, plugins:{legend:{display:true}}, scales:{y:{beginAtZero:true}} }
    });

    // Allowed by claim type
    const byType = {};
    for (const r of data){
      const k = r.ClaimType;
      byType[k] ??= {claims:0, allowed:0, denied:0};
      byType[k].claims++;
      byType[k].allowed += Number(r.Allowed||0);
      byType[k].denied  += Number(r.DeniedFlag||0);
    }
    const typeLabels = Object.keys(byType);
    const typeAllowed = typeLabels.map(k=>byType[k].allowed);

    new Chart(document.getElementById('allowedChart'), {
      type: 'bar',
      data: { labels: typeLabels, datasets: [{ label: 'Allowed $', data: typeAllowed }] },
      options: { responsive:true, plugins:{legend:{display:true}}, scales:{y:{beginAtZero:true}} }
    });

    // Table sample
    const tbody = document.querySelector('#tbl tbody');
    tbody.innerHTML = data.slice(0,15).map(r =>
      `<tr><td>${r.ClaimID}</td><td>${r.ClaimType}</td><td>${r.DateOfService}</td>
           <td>$${Number(r.Billed).toFixed(0)}</td><td>$${Number(r.Allowed).toFixed(0)}</td>
           <td>$${Number(r.Paid).toFixed(0)}</td><td>${r.DeniedFlag ? 'Yes':'No'}</td><td>${r.DenialCode||''}</td></tr>`
    ).join('');
  </script>

  <p style="margin-top:16px">
    <a class="btn" href="../" title="Back to repo">‚Üê Back to repository</a>
  </p>
</body>
</html>
